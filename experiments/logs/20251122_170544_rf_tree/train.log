Logging to experiments/logs/20251122_170544_rf_tree/train.log
Loading data...
Initializing preprocessor: TreePreprocessor
Preprocessing data...
Tree Preprocessor: Selected 18 features.
Categorical Features: ['region_group']
Selected features (18): ['environmental_score', 'social_score', 'governance_score', 'region_group', 'sect_C_pct', 'sect_G_pct', 'sect_J_pct', 'sect_M_pct', 'sect_N_pct', 'sect_OTHER_pct', 'env_score_adjustment', 'sdg_3', 'sdg_7', 'sdg_9', 'sdg_11', 'sdg_12', 'sdg_OTHER', 'revenue_log']
Initializing model: RandomForestModel

--- Training Target Scope 1 (CV) ---
Starting training with 5 folds... (Log Target: True)
Fold 1/5 - RMSE: 140909.7511, MAE: 56653.8265 | Log RMSE: 2.1780, Log MAE: 1.6511
Fold 2/5 - RMSE: 113988.6988, MAE: 55475.3957 | Log RMSE: 1.8692, Log MAE: 1.5193
Fold 3/5 - RMSE: 106077.1792, MAE: 46105.7162 | Log RMSE: 1.7062, Log MAE: 1.3553
Fold 4/5 - RMSE: 88313.5549, MAE: 37250.7782 | Log RMSE: 2.2001, Log MAE: 1.7066
Fold 5/5 - RMSE: 100628.0020, MAE: 48062.5222 | Log RMSE: 2.0453, Log MAE: 1.6377

Training Completed.
Mean RMSE: 109983.4372
Mean MAE: 48709.6478
Mean Log RMSE: 1.9998
Mean Log MAE: 1.5740

Top 5 Worst Predictions (Across all folds):
       actual     predicted      abs_error
420  637605.0  33290.270630  604314.729370
424  631252.0  39500.694648  591751.305352
421  598000.0  30291.309954  567708.690046
150  568478.0   7357.056918  561120.943082
416  559769.0   3533.222869  556235.777131

--- Training Target Scope 2 (CV) ---
Starting training with 5 folds... (Log Target: True)
Fold 1/5 - RMSE: 177864.1857, MAE: 61721.4289 | Log RMSE: 2.3580, Log MAE: 1.8050
Fold 2/5 - RMSE: 197073.5523, MAE: 61048.9067 | Log RMSE: 2.6951, Log MAE: 1.8339
Fold 3/5 - RMSE: 59429.1088, MAE: 30467.7429 | Log RMSE: 2.4838, Log MAE: 1.7631
Fold 4/5 - RMSE: 66170.2850, MAE: 29838.1184 | Log RMSE: 2.5868, Log MAE: 1.9230
Fold 5/5 - RMSE: 286895.6932, MAE: 76514.4325 | Log RMSE: 2.1766, Log MAE: 1.6989

Training Completed.
Mean RMSE: 157486.5650
Mean MAE: 51918.1259
Mean Log RMSE: 2.4601
Mean Log MAE: 1.8048

Top 5 Worst Predictions (Across all folds):
        actual     predicted     abs_error
428  2061608.0  15025.671484  2.046582e+06
427  1597469.0   2958.712721  1.594510e+06
426  1503357.0  40911.056863  1.462446e+06
425  1105788.0  31953.002618  1.073835e+06
424   862769.0  49912.845732  8.128562e+05
Metrics saved to metrics.json

--- Training Final Models and Generating Submission ---
Submission saved to experiments/logs/20251122_170544_rf_tree/submission.csv
