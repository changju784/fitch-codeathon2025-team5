Logging to experiments/logs/20251122_170742_ridge_comprehensive/train.log
Loading data...
Initializing preprocessor: ComprehensivePreprocessor
Preprocessing data...
Comprehensive Preprocessor: Selected 80 features.
Selected features (80): ['environmental_score', 'social_score', 'governance_score', 'sect_A_pct', 'sect_B_pct', 'sect_C_pct', 'sect_D_pct', 'sect_E_pct', 'sect_F_pct', 'sect_G_pct', 'sect_H_pct', 'sect_I_pct', 'sect_J_pct', 'sect_K_pct', 'sect_L_pct', 'sect_M_pct', 'sect_N_pct', 'sect_O_pct', 'sect_P_pct', 'sect_Q_pct', 'sect_R_pct', 'sect_S_pct', 'sect_T_pct', 'env_score_adjustment', 'env_act_Disposal\xa0', 'env_act_End-use', 'env_act_Farming', 'env_act_Manufacturing', 'env_act_Operation', 'env_act_Other', 'env_act_Raw materials', 'env_act_Transportation', 'sdg_id_2', 'sdg_id_3', 'sdg_id_4', 'sdg_id_5', 'sdg_id_6', 'sdg_id_7', 'sdg_id_8', 'sdg_id_9', 'sdg_id_11', 'sdg_id_12', 'sdg_id_13', 'sdg_id_16', 'revenue_log', 'region_code_ANZ', 'region_code_CAR', 'region_code_EA', 'region_code_EEU', 'region_code_LATAM', 'region_code_NAM', 'region_code_WEU', 'country_code_AT', 'country_code_BE', 'country_code_CA', 'country_code_CH', 'country_code_CN', 'country_code_CZ', 'country_code_DE', 'country_code_DK', 'country_code_EE', 'country_code_ES', 'country_code_FI', 'country_code_FR', 'country_code_GB', 'country_code_GI', 'country_code_IE', 'country_code_IT', 'country_code_JE', 'country_code_JP', 'country_code_LU', 'country_code_MT', 'country_code_MX', 'country_code_NL', 'country_code_NO', 'country_code_NZ', 'country_code_PR', 'country_code_PT', 'country_code_SE', 'country_code_US']
Initializing model: RidgeModel

--- Training Target Scope 1 (CV) ---
Starting training with 5 folds... (Log Target: True)
Fold 1/5 - RMSE: 300304.7914, MAE: 93018.4742 | Log RMSE: 2.0815, Log MAE: 1.6387
Fold 2/5 - RMSE: 114400.1640, MAE: 57239.9675 | Log RMSE: 1.7262, Log MAE: 1.4354
Fold 3/5 - RMSE: 22532949.7274, MAE: 2499382.4984 | Log RMSE: 2.1189, Log MAE: 1.5630
Fold 4/5 - RMSE: 179536.4374, MAE: 55611.1487 | Log RMSE: 2.0143, Log MAE: 1.5410
Fold 5/5 - RMSE: 138180.7795, MAE: 57378.7814 | Log RMSE: 1.8985, Log MAE: 1.5541

Training Completed.
Mean RMSE: 4653074.3800
Mean MAE: 552526.1740
Mean Log RMSE: 1.9679
Mean Log MAE: 1.5464

Top 5 Worst Predictions (Across all folds):
       actual     predicted     abs_error
234   63384.0  2.090173e+08  2.089539e+08
244   72515.0  2.404982e+06  2.332467e+06
236  308000.0  1.744206e+06  1.436206e+06
280    3000.0  1.331573e+06  1.328573e+06
422  229000.0  1.057550e+06  8.285502e+05

--- Training Target Scope 2 (CV) ---
Starting training with 5 folds... (Log Target: True)
Fold 1/5 - RMSE: 172465.6917, MAE: 60621.8170 | Log RMSE: 2.6346, Log MAE: 1.9861
Fold 2/5 - RMSE: 197511.0482, MAE: 62113.5705 | Log RMSE: 2.7853, Log MAE: 1.8347
Fold 3/5 - RMSE: 17114696.7365, MAE: 1884161.0123 | Log RMSE: 2.7599, Log MAE: 1.8662
Fold 4/5 - RMSE: 441168.4554, MAE: 86965.1723 | Log RMSE: 2.7418, Log MAE: 2.0165
Fold 5/5 - RMSE: 294780.5017, MAE: 83840.6074 | Log RMSE: 2.0790, Log MAE: 1.5604

Training Completed.
Mean RMSE: 3644124.4867
Mean MAE: 435540.4359
Mean Log RMSE: 2.6001
Mean Log MAE: 1.8528

Top 5 Worst Predictions (Across all folds):
        actual     predicted     abs_error
234    10645.0  1.587228e+08  1.587122e+08
236    11000.0  4.020559e+06  4.009559e+06
428  2061608.0  1.570536e+04  2.045903e+06
427  1597469.0  1.011368e+04  1.587355e+06
426  1503357.0  8.266982e+03  1.495090e+06
Metrics saved to metrics.json

--- Training Final Models and Generating Submission ---
Submission saved to experiments/logs/20251122_170742_ridge_comprehensive/submission.csv
