Logging to experiments/logs/20251122_170606_xgb_tree/train.log
Loading data...
Initializing preprocessor: TreePreprocessor
Preprocessing data...
Tree Preprocessor: Selected 18 features.
Categorical Features: ['region_group']
Selected features (18): ['environmental_score', 'social_score', 'governance_score', 'region_group', 'sect_C_pct', 'sect_G_pct', 'sect_J_pct', 'sect_M_pct', 'sect_N_pct', 'sect_OTHER_pct', 'env_score_adjustment', 'sdg_3', 'sdg_7', 'sdg_9', 'sdg_11', 'sdg_12', 'sdg_OTHER', 'revenue_log']
Initializing model: XGBoostModel

--- Training Target Scope 1 (CV) ---
Starting training with 5 folds... (Log Target: True)
Fold 1/5 - RMSE: 135730.1159, MAE: 56986.4641 | Log RMSE: 2.1868, Log MAE: 1.6912
Fold 2/5 - RMSE: 114417.7633, MAE: 57502.6818 | Log RMSE: 1.9927, Log MAE: 1.5717
Fold 3/5 - RMSE: 116123.5768, MAE: 52833.9985 | Log RMSE: 1.8257, Log MAE: 1.4430
Fold 4/5 - RMSE: 91908.3629, MAE: 43286.9407 | Log RMSE: 2.3241, Log MAE: 1.8632
Fold 5/5 - RMSE: 101487.6126, MAE: 51032.6385 | Log RMSE: 2.1671, Log MAE: 1.7207

Training Completed.
Mean RMSE: 111933.4863
Mean MAE: 52328.5447
Mean Log RMSE: 2.0993
Mean Log MAE: 1.6580

Top 5 Worst Predictions (Across all folds):
       actual     predicted      abs_error
420  637605.0  40380.375000  597224.625000
424  631252.0  53458.042969  577793.957031
150  568478.0   5460.185059  563017.814941
416  559769.0   5474.228516  554294.771484
396  577624.0  47375.675781  530248.324219

--- Training Target Scope 2 (CV) ---
Starting training with 5 folds... (Log Target: True)
Fold 1/5 - RMSE: 177954.6484, MAE: 63027.5597 | Log RMSE: 2.6273, Log MAE: 2.1065
Fold 2/5 - RMSE: 195562.0817, MAE: 59711.9978 | Log RMSE: 2.8321, Log MAE: 1.9120
Fold 3/5 - RMSE: 61343.9130, MAE: 31222.9919 | Log RMSE: 2.7485, Log MAE: 1.9259
Fold 4/5 - RMSE: 75533.5704, MAE: 34306.3055 | Log RMSE: 2.6175, Log MAE: 1.9577
Fold 5/5 - RMSE: 276690.2613, MAE: 76180.1558 | Log RMSE: 2.2800, Log MAE: 1.8210

Training Completed.
Mean RMSE: 157416.8950
Mean MAE: 52889.8021
Mean Log RMSE: 2.6211
Mean Log MAE: 1.9446

Top 5 Worst Predictions (Across all folds):
        actual      predicted     abs_error
428  2061608.0   23784.894531  2.037823e+06
427  1597469.0    7766.195801  1.589703e+06
426  1503357.0  231862.859375  1.271494e+06
425  1105788.0   52551.597656  1.053236e+06
424   862769.0   46627.960938  8.161410e+05
Metrics saved to metrics.json

--- Training Final Models and Generating Submission ---
Submission saved to experiments/logs/20251122_170606_xgb_tree/submission.csv
