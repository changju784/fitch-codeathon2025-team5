Logging to experiments/logs/20251122_165823_ridge_top_features/train.log
Loading data...
Initializing preprocessor: TopFeaturesPreprocessor
Preprocessing data...
TopFeatures Preprocessor: Selected 20 features.
Features: ['environmental_score', 'social_score', 'governance_score', 'sect_C_pct', 'sect_G_pct', 'sect_J_pct', 'sect_M_pct', 'sect_N_pct', 'sect_OTHER_pct', 'env_score_adjustment', 'sdg_3', 'sdg_7', 'sdg_9', 'sdg_11', 'sdg_12', 'sdg_OTHER', 'revenue_log', 'region_group_NAM', 'region_group_OTHER', 'region_group_WEU']
Selected features (20): ['environmental_score', 'social_score', 'governance_score', 'sect_C_pct', 'sect_G_pct', 'sect_J_pct', 'sect_M_pct', 'sect_N_pct', 'sect_OTHER_pct', 'env_score_adjustment', 'sdg_3', 'sdg_7', 'sdg_9', 'sdg_11', 'sdg_12', 'sdg_OTHER', 'revenue_log', 'region_group_NAM', 'region_group_OTHER', 'region_group_WEU']
Initializing model: RidgeModel

--- Training Target Scope 1 (CV) ---
Starting training with 5 folds... (Log Target: True)
Fold 1/5 - RMSE: 140547.8332, MAE: 57548.5851 | Log RMSE: 2.0310, Log MAE: 1.6152
Fold 2/5 - RMSE: 113204.1887, MAE: 57283.1087 | Log RMSE: 1.9339, Log MAE: 1.5665
Fold 3/5 - RMSE: 113550.1193, MAE: 50823.6449 | Log RMSE: 1.8108, Log MAE: 1.4108
Fold 4/5 - RMSE: 91372.0320, MAE: 41670.0805 | Log RMSE: 2.2154, Log MAE: 1.7774
Fold 5/5 - RMSE: 114290.5367, MAE: 49822.6647 | Log RMSE: 2.0636, Log MAE: 1.5487

Training Completed.
Mean RMSE: 114592.9420
Mean MAE: 51429.6168
Mean Log RMSE: 2.0109
Mean Log MAE: 1.5837

Top 5 Worst Predictions (Across all folds):
       actual      predicted      abs_error
422  229000.0  887031.613241  658031.613241
420  637605.0   57923.222452  579681.777548
424  631252.0   61865.467777  569386.532223
150  568478.0    5472.090442  563005.909558
416  559769.0    3407.931045  556361.068955

--- Training Target Scope 2 (CV) ---
Starting training with 5 folds... (Log Target: True)
Fold 1/5 - RMSE: 174377.0676, MAE: 59424.7688 | Log RMSE: 2.3334, Log MAE: 1.7471
Fold 2/5 - RMSE: 194932.0211, MAE: 60973.7220 | Log RMSE: 2.7125, Log MAE: 1.7910
Fold 3/5 - RMSE: 59336.1479, MAE: 30677.3530 | Log RMSE: 2.4589, Log MAE: 1.7339
Fold 4/5 - RMSE: 64195.8792, MAE: 29428.4645 | Log RMSE: 2.4967, Log MAE: 1.8342
Fold 5/5 - RMSE: 295503.5623, MAE: 81539.6724 | Log RMSE: 2.1752, Log MAE: 1.6661

Training Completed.
Mean RMSE: 157668.9356
Mean MAE: 52408.7961
Mean Log RMSE: 2.4354
Mean Log MAE: 1.7545

Top 5 Worst Predictions (Across all folds):
        actual     predicted     abs_error
428  2061608.0   5538.200175  2.056070e+06
427  1597469.0  15320.579488  1.582148e+06
426  1503357.0  28734.924088  1.474622e+06
425  1105788.0  52546.043769  1.053242e+06
424   862769.0  62335.744123  8.004333e+05
Metrics saved to metrics.json

--- Training Final Models and Generating Submission ---
Submission saved to experiments/logs/20251122_165823_ridge_top_features/submission.csv
